<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>TripletShortCycles Class</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="TripletShortCycles class" /><meta name="System.Keywords" content="NCDK.Graphs.TripletShortCycles class" /><meta name="Microsoft.Help.F1" content="NCDK.Graphs.TripletShortCycles" /><meta name="Microsoft.Help.Id" content="T:NCDK.Graphs.TripletShortCycles" /><meta name="Description" content="Compute the shortest cycles through each vertex triple. This allows one to directly obtain the envelope rings of bicyclic fused system." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="NCDK.Graphs" /><meta name="file" content="T_NCDK_Graphs_TripletShortCycles" /><meta name="guid" content="T_NCDK_Graphs_TripletShortCycles" /><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">NCDK Chemistry Development Kit Class Library<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="e2ff06cc-99b7-4f8b-95c5-53965548639f.htm" title="NCDK Chemistry Development Kit Class Library" tocid="roottoc">NCDK Chemistry Development Kit Class Library</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/N_NCDK_Graphs.htm" title="NCDK.Graphs" tocid="N_NCDK_Graphs">NCDK.Graphs</a></div><div class="toclevel1 current" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="T_NCDK_Graphs_TripletShortCycles.htm" title="TripletShortCycles Class" tocid="T_NCDK_Graphs_TripletShortCycles">TripletShortCycles Class</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_NCDK_Graphs_TripletShortCycles__ctor.htm" title="TripletShortCycles Constructor " tocid="M_NCDK_Graphs_TripletShortCycles__ctor">TripletShortCycles Constructor </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Properties_T_NCDK_Graphs_TripletShortCycles.htm" title="TripletShortCycles Properties" tocid="Properties_T_NCDK_Graphs_TripletShortCycles">TripletShortCycles Properties</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Methods_T_NCDK_Graphs_TripletShortCycles.htm" title="TripletShortCycles Methods" tocid="Methods_T_NCDK_Graphs_TripletShortCycles">TripletShortCycles Methods</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>TripletShortCycles Class</h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            Compute the shortest cycles through each vertex triple. This allows one to
            directly obtain the envelope rings of bicyclic fused system. These cycles
            can be thought of as the 'ESSSR' (extended smallest set of smallest rings)
            and 'envelope' rings as used by PubChem fingerprints (CACTVS Substructure
            Keys). The PubChem fingerprint documentation exclusively refers to the ESSSR
            and envelopes as just the ESSSR and the rest of this documentation does the
            same. This class provides the cycles (vertex paths) for each ring in the
            ESSSR.
            </div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Inheritance Hierarchy</span></div><div id="ID0RBSection" class="collapsibleSection"><a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">System<span id="LSTB86C11FF_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTB86C11FF_0?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Object</a><br />  <span class="selflink">NCDK.Graphs<span id="LSTB86C11FF_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTB86C11FF_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>TripletShortCycles</span><br /></div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_NCDK_Graphs.htm">NCDK.Graphs</a><br />
    <strong>Assembly:</strong>
   NCDK (in NCDK.dll) Version: 1.0.0.0 (1.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1EACA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EACA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EACA');return false;" title="Copy">Copy</a></div></div><div id="ID1EACA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="identifier">TripletShortCycles</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EACA");</script></div><p>The <span class="selflink">TripletShortCycles</span> type exposes the following members.</p><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Constructors</span></div><div id="ID3RBSection" class="collapsibleSection"><table class="members" id="constructorList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_NCDK_Graphs_TripletShortCycles__ctor.htm">TripletShortCycles</a></td><td><div class="summary">
            Compute the cycles of the extended smallest set of smallest rings (ESSSR)
            for an existing minimum cycle basis. Choosing the set to be canonical
            means the set depends on the order of the vertices and may <b>not</b> be
            consistent in subgraphs. Given a different order of vertices the same
            cycles may not be found.
            </div></td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Properties</span></div><div id="ID4RBSection" class="collapsibleSection"><table class="members" id="propertyList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /></td><td><a href="P_NCDK_Graphs_TripletShortCycles_Count.htm">Count</a></td><td><div class="summary">
            Size of the cycle basis, cardinality of the ESSSR.
            </div></td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID5RB')" onkeypress="SectionExpandCollapse_CheckKey('ID5RB', event)" tabindex="0"><img id="ID5RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Methods</span></div><div id="ID5RBSection" class="collapsibleSection"><table class="members" id="methodList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/bsc2ak47" target="_blank">Equals</a></td><td> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/zdee4b3y" target="_blank">GetHashCode</a></td><td> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_NCDK_Graphs_TripletShortCycles_GetPaths.htm">GetPaths</a></td><td><div class="summary">
            Access the vertex paths for all cycles of the basis.
            </div></td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/dfwy45w9" target="_blank">GetType</a></td><td> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/7bxwbwt2" target="_blank">ToString</a></td><td> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID6RB')" onkeypress="SectionExpandCollapse_CheckKey('ID6RB', event)" tabindex="0"><img id="ID6RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID6RBSection" class="collapsibleSection"><p>
            The ESSSR should not be confused with the extended set of smallest rings
            (ESSR) Downs, G and Gillet, V and Holliday, J, and Lynch, M, <i>Theoretical Aspects of Ring Perception and Development of the Extended Set of Smallest Ring Concepts</i>, J. Chem. Inf. Comput. Sci, <b>1989</b>, 29:187-206.
            </p><b>Algorithm</b><p>
            To our knowledge no algorithm has been published for
            the ESSSR. The <a href="ftp://ftp.ncbi.nlm.nih.gov/pubchem/specifications/pubchem_fingerprints.pdf" target="_blank">PubChem Specifications</a>
            states - <i>"An ESSSR ring is any ring which does not
            share three consecutive atoms with any other ring in the chemical structure.
            For example, naphthalene has three ESSSR rings (two phenyl fragments and the
            10-membered envelope), while biphenyl will yield a count of only two ESSSR
            rings"</i>. The name implies the use of the smallest set of smallest rings
            (SSSR). Not every graph has an SSSR and so the minimum cycle basis is used
            instead. With this modification the algorithm is outlined below. 
            </p><ul><li>Compute a minimum cycle basis (or SSSR) of the graph (may not be unique)</li><li>For each vertex 'v' and two adjacent vertices ('u' and <i>w</i>) check if the path <i>-u-v-w-</i> belongs to any cycles already in the basis</li><li>If no such cycle can be found compute the shortest cycle which travels through <i>-u-v-w-</i> and add it to the basis. The shortest cycle is the shortest path from 'u' to <i>w</i> which does not travel through 'v'</li></ul><p>
            In the case of <i>naphthalene</i> the
            minimum cycle basis is the two phenyl rings. Taking either bridgehead atom of
            <i>naphthalene</i> to be 'v' and choosing 'u' and <i>w</i> to be in
            different phenyl rings it is easy to see the shortest cycle through
            <i>-u-v-w-</i> is the 10 member envelope ring.
            </p><b>Canonical and Non-Canonical Generation</b><p>
            The algorithm can generate a canonical or non-canonical (preferred) set of
            cycles. As one can see from the above description depending on the order we
            check each triple (-u-v-w-) and add it to basis we may end up with a
            different set.
            </p><p>
            To avoid this PubChem fingerprints uses a canonical labelling ensuring the
            vertices are always checked in the same order. The vertex order used by this
            class is the natural order of the vertices as provided in the graph. To
            ensure the generated set is always the same vertices should be ordered
            beforehand or the non-canonical option should be used.
            </p><p>
            Although this canonical sorting allows one to reliable generate the same set
            of cycles for a graph this is not true for subgraphs. For two graphs
            <i>G</i>, <i>H</i> and a canonical ordering (<i>π</i>). If <i>H</i> is a
            subgraph of <i>G</i> then for two vertices 'u', 'v'. It follows
            that <i>π(u)</i> &lt; <i>π(v)</i> ∈ <i>H</i> ⇏ <i>π(u)</i> &lt; <i>π(v)</i> ∈
            <i>G</i>. In other words, we can canonically label a graph and inspect the
            ordering of vertices 'u' and 'v'. We now take a subgraph which
            contains both 'u' and 'v' - the ordering does not need to be the
            same as the full graph. This means that a subgraph may contain a ring in its
            ESSSR which does not belong to the ESSSR of the full graph.
            </p><p>
            To resolve this problem you can turn off the <span class="nolink">canonical</span> option. This
            relaxes the existing condition (Step 2.) and adds all shortest cycles through
            each triple (-u-v-w-) to the basis. The number of cycles generated may be
            larger however it is now possible to ensure that if <i>H</i> is a subgraph of
            <i>G</i> then ESSSR of <i>H</i> will be a subset of the ESSSR or <i>G</i>.
            Alternatively one may consider using the <a href="T_NCDK_Graphs_RelevantCycles.htm">RelevantCycles</a> which is the
            the smallest set of short cycles which is <i>uniquely</i> defined for a
            graph.
            </p><p>
            To better explain the issue with the canonical labelling several examples are
            shown below. The table outlining the size of rings found for each molecule
            when using canonical and non-canonical generation. Also shown are the sizes
            of rings stored in the PubChem fingerprint associated with the entry. The
            fingerprints were obtained directly from PubChem and decoded using the 
            <a href="ftp://ftp.ncbi.nlm.nih.gov/pubchem/specifications/pubchem_fingerprints.pdf" target="_blank">specification</a>.
            Sizes underlined and coloured red represent rings which may
            or may not be present depending on the atom ordering. It can be seen from the
            PubChem fingerprint that even using a consistent canonical labelling rings
            may be absent which would be present if the subgraph was used.
            </p><div class="tableSection"><table><tr><th>PubChem CID</th><th>Diagram</th><th>Size of Rings in ESSSR (fingerprints only store cycles |C| &lt;=10)</th><th>Source</th></tr><tr><td>CID <a href="http://pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=135973" target="_blank">135973</a></td><td><img src="http://pubchem.ncbi.nlm.nih.gov/image/imgsrv.fcgi?cid=135973" alt="Compound Image" /></td><td><div class="tableSection"><table><tr><td>{3, 3, 4}</td></tr><tr><td>{3, 3, 4}</td></tr><tr><td>{3, 3, 4}</td></tr></table></div></td><td><div class="tableSection"><table><tr><td>Canonical</td></tr><tr><td>Non-canonical</td></tr><tr><td>PubChem Fingerprint</td></tr></table></div></td></tr><tr><td>CID <a href="http://pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=9249" target="_blank">9249</a></td><td><img src="http://pubchem.ncbi.nlm.nih.gov/image/imgsrv.fcgi?cid=9249" alt="Compound Image" /></td><td><div class="tableSection"><table><tr><td>{3, 3, <b style="color: #FF4444;"><u>4</u></b>, 6, 6}</td></tr><tr><td>{3, 3, 4, 6, 6}</td></tr><tr><td>{3, 3, 6, 6}</td></tr></table></div></td><td><div class="tableSection"><table><tr><td>Canonical - <i>4 member cycle only added if found before larger 6
            member cycles</i></td></tr><tr><td>Non-canonical</td></tr><tr><td>PubChem Fingerprint - <i>4 member cycle not found</i></td></tr></table></div></td></tr><tr><td>CID <a href="http://pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=931" target="_blank">931</a></td><td><img src="http://pubchem.ncbi.nlm.nih.gov/image/imgsrv.fcgi?cid=931" alt="Compound Image" /></td><td><div class="tableSection"><table><tr><td>{6, 6, 10}</td></tr><tr><td>{6, 6, 10}</td></tr><tr><td>{6, 6, 10}</td></tr></table></div></td><td><div class="tableSection"><table><tr><td>Canonical</td></tr><tr><td>Non-canonical</td></tr><tr><td>PubChem Fingerprint</td></tr></table></div></td></tr><tr><td>CID <a href="http://pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=5702" target="_blank">5702</a></td><td><img src="http://pubchem.ncbi.nlm.nih.gov/image/imgsrv.fcgi?cid=5702" alt="Compound Image" /></td><td><div class="tableSection"><table><tr><td>{6, 6, 6, 6, <b style="color: #FF4444;"><u>10</u></b>, <b style="color: #FF4444;"><u>10</u></b>, 20, 22, 22, 24, 24}</td></tr><tr><td>{6, 6, 6, 6, 10, 10, 20, 22, 22, 24, 24}</td></tr><tr><td>{6, 6, 6, 6}</td></tr></table></div></td><td><div class="tableSection"><table><tr><td>Canonical - <i>10 member cycles only added if found before larger
            cycles</i></td></tr><tr><td>Non-canonical</td></tr><tr><td>PubChem Fingerprint - <i>10 member cycles not found</i></td></tr></table></div></td></tr><tr><td>CID <a href="http://pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=1211" target="_blank">1211</a></td><td><img src="http://pubchem.ncbi.nlm.nih.gov/image/imgsrv.fcgi?cid=1211" alt="Compound Image" /></td><td><div class="tableSection"><table><tr><td>{6, 6, 6, 6, 6, 6, <b style="color: #FF4444;"><u>10</u></b>, <b><u>10</u></b>, 18, 18, 20, 20, 22, 22, 22}</td></tr><tr><td>{6, 6, 6, 6, 6, 6, 10, 10, 18, 18, 20, 20, 22, 22, 22}</td></tr><tr><td>{6, 6, 6, 6, 6, 6, 10, 10}</td></tr></table></div></td><td><div class="tableSection"><table><tr><td>Canonical - <i>10 member cycles only added if found before larger cycles</i></td></tr><tr><td>Non-canonical</td></tr><tr><td>PubChem Fingerprint - <i>10 member cycles were found</i></td></tr></table></div></td></tr><tr><td>CID <a href="http://pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=17858819" target="_blank">17858819</a></td><td><img src="http://pubchem.ncbi.nlm.nih.gov/image/imgsrv.fcgi?cid=17858819" alt="Compound Image" /></td><td><div class="tableSection"><table><tr><td>{5, 6, 9}</td></tr><tr><td>{5, 6, 9}</td></tr><tr><td>{5, 6, 9}</td></tr></table></div></td><td><div class="tableSection"><table><tr><td>Canonical</td></tr><tr><td>Non-canonical</td></tr><tr><td>PubChem Fingerprint</td></tr></table></div></td></tr><tr><td>CID <a href="http://pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=1909" target="_blank">1909</a></td><td><img src="http://pubchem.ncbi.nlm.nih.gov/image/imgsrv.fcgi?cid=1909" alt="Compound Image" /></td><td><div class="tableSection"><table><tr><td>{5, 5, 5, 6, <b style="color: #FF4444;"><u>9</u></b>, 16, 17, 17, 17, 18}</td></tr><tr><td>{5, 5, 5, 6, 9, 16, 17, 17, 17, 18}</td></tr><tr><td>{5, 5, 5, 6}</td></tr></table></div></td><td><div class="tableSection"><table><tr><td>Canonical - <i>9 member cycle only added if found before larger cycles</i></td></tr><tr><td>Non-canonical</td></tr><tr><td>PubChem Fingerprint - <i>9 member cycle not found</i></td></tr></table></div></td></tr></table></div></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID7RB')" onkeypress="SectionExpandCollapse_CheckKey('ID7RB', event)" tabindex="0"><img id="ID7RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID7RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="N_NCDK_Graphs.htm">NCDK.Graphs Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"><p>Copyright © 2016-2017 Kazuya Ujihara</p> </div></body></html>