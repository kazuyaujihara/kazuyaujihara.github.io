<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>SmartsFragmentExtractor Class</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="SmartsFragmentExtractor class" /><meta name="System.Keywords" content="NCDK.SMARTS.SmartsFragmentExtractor class" /><meta name="Microsoft.Help.F1" content="NCDK.SMARTS.SmartsFragmentExtractor" /><meta name="Microsoft.Help.Id" content="T:NCDK.SMARTS.SmartsFragmentExtractor" /><meta name="Description" content="Utility class to create SMARTS that match part (substructure) of a molecule. SMARTS are generated by providing the atom indexes. An example use cases is encoding features from a fingerprint." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="NCDK.SMARTS" /><meta name="file" content="T_NCDK_SMARTS_SmartsFragmentExtractor" /><meta name="guid" content="T_NCDK_SMARTS_SmartsFragmentExtractor" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">NCDK Chemistry Development Kit Class Library<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html\e2ff06cc-99b7-4f8b-95c5-53965548639f.htm" title="NCDK Chemistry Development Kit Class Library" tocid="roottoc">NCDK Chemistry Development Kit Class Library</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/N_NCDK_SMARTS.htm" title="NCDK.SMARTS" tocid="N_NCDK_SMARTS">NCDK.SMARTS</a></div><div class="toclevel1 current" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/T_NCDK_SMARTS_SmartsFragmentExtractor.htm" title="SmartsFragmentExtractor Class" tocid="T_NCDK_SMARTS_SmartsFragmentExtractor">SmartsFragmentExtractor Class</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="../html/M_NCDK_SMARTS_SmartsFragmentExtractor__ctor.htm" title="SmartsFragmentExtractor Constructor " tocid="M_NCDK_SMARTS_SmartsFragmentExtractor__ctor">SmartsFragmentExtractor Constructor </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/Methods_T_NCDK_SMARTS_SmartsFragmentExtractor.htm" title="SmartsFragmentExtractor Methods" tocid="Methods_T_NCDK_SMARTS_SmartsFragmentExtractor">SmartsFragmentExtractor Methods</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>SmartsFragmentExtractor Class</h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            Utility class to create SMARTS that match part (substructure) of a molecule.
            SMARTS are generated by providing the atom indexes. An example use cases is
            encoding features from a fingerprint.
            </div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Inheritance Hierarchy</span></div><div id="ID0RBSection" class="collapsibleSection"><a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">System<span id="LSTCDE7D8E9_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTCDE7D8E9_0?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Object</a><br />  <span class="selflink">NCDK.SMARTS<span id="LSTCDE7D8E9_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTCDE7D8E9_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SmartsFragmentExtractor</span><br /></div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_NCDK_SMARTS.htm">NCDK.SMARTS</a><br />
    <strong>Assembly:</strong>
   NCDK (in NCDK.dll) Version: 1.5<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1EACA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EACA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EACA');return false;" title="Copy">Copy</a></div></div><div id="ID1EACA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">sealed</span> <span class="keyword">class</span> <span class="identifier">SmartsFragmentExtractor</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EACA");</script><a id="HT_RequestExampleLink" href="https://github.com/kazuyaujihara/NCDK/issues/new" target="_blank" class="button" title="Request an example for this topic">Request Example</a>
		<script type="text/javascript">
		var HT_requestExampleLink = document.getElementById("HT_RequestExampleLink");
		var HT_requestExampleLinkText = HT_requestExampleLink.innerHTML;
				
		if(HT_requestExampleLink.href.substring(0, 4).toLowerCase() == "http")
			HT_requestExampleLink.href += "?title=";
		else
			HT_requestExampleLink.href += "?subject=NCDK Chemistry Development Kit Class Library: ";

		HT_requestExampleLink.href += "Add an Example for " + encodeURIComponent(document.title) + "&amp;body=" +
			encodeURIComponent("Please add an example for " + document.title + ".%0D%0DTODO (optional): Describe a specific " +
			"scenario you would like to see addressed.%0D%0DHelp Topic: " + window.location.href).replace(/%250D/g, "%0D");
		HT_requestExampleLink.innerHTML = HT_requestExampleLinkText;
		</script><a target="_blank" class="button" href="https://github.com/kazuyaujihara/NCDK/tree/master/NCDK/SMARTS/SmartsFragmentExtractor.cs" title="View the source code">View Source</a></div><p>The <span class="selflink">SmartsFragmentExtractor</span> type exposes the following members.</p><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Constructors</span></div><div id="ID3RBSection" class="collapsibleSection"><table class="members" id="constructorList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_NCDK_SMARTS_SmartsFragmentExtractor__ctor.htm">SmartsFragmentExtractor</a></td><td><div class="summary">
            Create a new instance over the provided molecule.
            </div></td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Methods</span></div><div id="ID4RBSection" class="collapsibleSection"><table class="members" id="methodList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/bsc2ak47" target="_blank">Equals</a></td><td><div class="summary">Determines whether the specified object is equal to the current object.</div> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_NCDK_SMARTS_SmartsFragmentExtractor_Generate.htm">Generate</a></td><td><div class="summary">
            Generate a SMARTS for the substructure formed of the provided
            atoms.
            </div></td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/zdee4b3y" target="_blank">GetHashCode</a></td><td><div class="summary">Serves as the default hash function. </div> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/dfwy45w9" target="_blank">GetType</a></td><td><div class="summary">Gets the <a href="http://msdn2.microsoft.com/en-us/library/42892f65" target="_blank">Type</a> of the current instance.</div> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_NCDK_SMARTS_SmartsFragmentExtractor_SetMode.htm">SetMode</a></td><td><div class="summary">
            Set the mode of SMARTS substructure selection
            </div></td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/7bxwbwt2" target="_blank">ToString</a></td><td><div class="summary">Returns a string that represents the current object.</div> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID5RB')" onkeypress="SectionExpandCollapse_CheckKey('ID5RB', event)" tabindex="0"><img id="ID5RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID5RBSection" class="collapsibleSection"><p>
            The extractor has two modes. <a href="T_NCDK_SMARTS_SubstructureSelectionMode.htm">ExactSmarts</a> (default) captures the element,
            valence, hydrogen count, connectivity, and charge in the SMARTS atom expressions.
            The alternative mode, <a href="T_NCDK_SMARTS_SubstructureSelectionMode.htm">JCompoundMapper</a>, only captures the element,
            non-zero charge, and peripheral bonds. Although the later looks cleaner, the
            peripheral bonds intend to capture the connectivity of the terminal atoms but
            since the valence is not bounded further substitution is still allowed. This
            mirrors functionality from jCompoundMapper 
    <a href="https://dx.doi.org/10.1186/1758-2946-3-3">Hinselmann and Georg and Rosenbaum and Lars and Jahn and Andreas and Fechner and Nikolas and Zell and Andreas, <i>jCompoundMapper: An open source Java library and command line tool for chemical fingerprints</i>, Journal of Cheminformatics, <b>2011</b>, 3:1-14</a>
  .
            </p><p>
            The difference is easily demonstrated for methyl. Consider the compound
            of 2-methylpentane "CC(C)CCC", if we extract one of the methyl atoms
            depending on the mode we obtain "[CH3v4X4+0]" or "C*". The first
            of these patterns (obtained by <a href="T_NCDK_SMARTS_SubstructureSelectionMode.htm">ExactSmarts</a>) matches the compound in
            <b>three places</b> (the three methyl groups). The second matches <b>six</b>
            times (every atom) because the substituion on the carbon is not locked.
            A further complication is introduced by the inclusion of the peripheral atoms,
            for 1H-indole "[nH]1ccc2c1cccc2" we can obtain the SMARTS "n(ccc(a)a)a"
            that doesn't match at all. This is because one of the aromatic atoms ('a')
            needs to match the nitrogen.
            </p></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID6RB')" onkeypress="SectionExpandCollapse_CheckKey('ID6RB', event)" tabindex="0"><img id="ID6RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Examples</span></div><div id="ID6RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EAAABA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EAAABA');return false;" title="Copy">Copy</a></div></div><div id="ID1EAAABA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="highlight-keyword">var</span> smipar = <span class="highlight-keyword">new</span> SmilesParser();

IAtomContainer mol = smipar.ParseSmiles(<span class="highlight-literal">"[nH]1ccc2c1cccc2"</span>);
<span class="highlight-keyword">var</span> subsmarts = <span class="highlight-keyword">new</span> SmartsFragmentExtractor(mol);

<span class="highlight-keyword">string</span> smarts;
<span class="highlight-comment">// smarts=[nH1v3X3+0][cH1v4X3+0][cH1v4X3+0][cH0v4X3+0]</span>
<span class="highlight-comment">// hits  =1</span>
smarts = subsmarts.Generate(<span class="highlight-keyword">new</span> <span class="highlight-keyword">int</span>[]{<span class="highlight-number">0</span>,<span class="highlight-number">1</span>,<span class="highlight-number">3</span>,<span class="highlight-number">4</span>});

subsmarts.SetMode(SubstructureSelectionMode.JCompoundMapper);
<span class="highlight-comment">// smarts=n(ccc(a)a)a</span>
<span class="highlight-comment">// hits  = 0 - one of the 'a' atoms needs to match the nitrogen</span>
smarts = subsmarts.Generate(<span class="highlight-keyword">new</span> <span class="highlight-keyword">int</span>[]{<span class="highlight-number">0</span>,<span class="highlight-number">1</span>,<span class="highlight-number">3</span>,<span class="highlight-number">4</span>});</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EAAABA");</script></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID7RB')" onkeypress="SectionExpandCollapse_CheckKey('ID7RB', event)" tabindex="0"><img id="ID7RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID7RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="N_NCDK_SMARTS.htm">NCDK.SMARTS Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"><p>Copyright © 2016-2018 Kazuya Ujihara</p> </div></body></html>