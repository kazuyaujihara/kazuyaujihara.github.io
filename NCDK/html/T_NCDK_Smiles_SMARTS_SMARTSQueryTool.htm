<html><head><meta http-equiv="X-UA-Compatible" content="IE=edge" /><link rel="shortcut icon" href="../icons/favicon.ico" /><link rel="stylesheet" type="text/css" href="../styles/branding.css" /><link rel="stylesheet" type="text/css" href="../styles/branding-en-US.css" /><script type="text/javascript" src="../scripts/branding.js"> </script><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>SMARTSQueryTool Class</title><meta name="Language" content="en-us" /><meta name="System.Keywords" content="SMARTSQueryTool class" /><meta name="System.Keywords" content="NCDK.Smiles.SMARTS.SMARTSQueryTool class" /><meta name="Microsoft.Help.F1" content="NCDK.Smiles.SMARTS.SMARTSQueryTool" /><meta name="Microsoft.Help.Id" content="T:NCDK.Smiles.SMARTS.SMARTSQueryTool" /><meta name="Description" content="This class provides a easy to use wrapper around SMARTS matching functionality." /><meta name="Microsoft.Help.ContentType" content="Reference" /><meta name="BrandingAware" content="true" /><meta name="container" content="NCDK.Smiles.SMARTS" /><meta name="file" content="T_NCDK_Smiles_SMARTS_SMARTSQueryTool" /><meta name="guid" content="T_NCDK_Smiles_SMARTS_SMARTSQueryTool" /><link type="text/css" rel="stylesheet" href="../styles/highlight.css" /><script type="text/javascript" src="../scripts/highlight.js"> </script><link rel="stylesheet" type="text/css" href="../styles/branding-Website.css" /><script type="text/javascript" src="../scripts/jquery-1.11.0.min.js"></script><script type="text/javascript" src="../scripts/branding-Website.js"></script><script type="text/javascript" src="../scripts/clipboard.min.js"></script></head><body onload="OnLoad('cs')"><input type="hidden" id="userDataCache" class="userDataStyle" /><div class="pageHeader" id="PageHeader">NCDK Chemistry Development Kit Class Library<form id="SearchForm" method="get" action="#" onsubmit="javascript:TransferToSearchPage(); return false;"><input id="SearchTextBox" type="text" maxlength="200" /><button id="SearchButton" type="submit"></button></form></div><div class="pageBody"><div class="leftNav" id="leftNav"><div id="tocNav"><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="e2ff06cc-99b7-4f8b-95c5-53965548639f.htm" title="NCDK Chemistry Development Kit Class Library" tocid="roottoc">NCDK Chemistry Development Kit Class Library</a></div><div class="toclevel0" data-toclevel="0"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="../html/N_NCDK_Smiles_SMARTS.htm" title="NCDK.Smiles.SMARTS" tocid="N_NCDK_Smiles_SMARTS">NCDK.Smiles.SMARTS</a></div><div class="toclevel1 current" data-toclevel="1" data-childrenloaded="true"><a class="tocExpanded" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="T_NCDK_Smiles_SMARTS_SMARTSQueryTool.htm" title="SMARTSQueryTool Class" tocid="T_NCDK_Smiles_SMARTS_SMARTSQueryTool">SMARTSQueryTool Class</a></div><div class="toclevel2" data-toclevel="2"><a data-tochassubtree="false" href="M_NCDK_Smiles_SMARTS_SMARTSQueryTool__ctor.htm" title="SMARTSQueryTool Constructor " tocid="M_NCDK_Smiles_SMARTS_SMARTSQueryTool__ctor">SMARTSQueryTool Constructor </a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Properties_T_NCDK_Smiles_SMARTS_SMARTSQueryTool.htm" title="SMARTSQueryTool Properties" tocid="Properties_T_NCDK_Smiles_SMARTS_SMARTSQueryTool">SMARTSQueryTool Properties</a></div><div class="toclevel2" data-toclevel="2"><a class="tocCollapsed" onclick="javascript: Toggle(this);" href="#!" /><a data-tochassubtree="true" href="Methods_T_NCDK_Smiles_SMARTS_SMARTSQueryTool.htm" title="SMARTSQueryTool Methods" tocid="Methods_T_NCDK_Smiles_SMARTS_SMARTSQueryTool">SMARTSQueryTool Methods</a></div></div><div id="tocResizableEW" onmousedown="OnMouseDown(event);"></div><div id="TocResize" class="tocResize"><img id="ResizeImageIncrease" src="../icons/TocOpen.gif" onclick="OnIncreaseToc()" alt="Click or drag to resize" title="Click or drag to resize" /><img id="ResizeImageReset" src="../icons/TocClose.gif" style="display:none" onclick="OnResetToc()" alt="Click or drag to resize" title="Click or drag to resize" /></div></div><div class="topicContent" id="TopicContent"><table class="titleTable"><tr><td class="logoColumn"><img src="../icons/Help.png" /></td><td class="titleColumn"><h1>SMARTSQueryTool Class</h1></td></tr></table><span class="introStyle"></span> <div class="summary">
            This class provides a easy to use wrapper around SMARTS matching functionality. 
            </div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID0RB')" onkeypress="SectionExpandCollapse_CheckKey('ID0RB', event)" tabindex="0"><img id="ID0RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Inheritance Hierarchy</span></div><div id="ID0RBSection" class="collapsibleSection"><a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">System<span id="LSTD981E187_0"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD981E187_0?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>Object</a><br />  <span class="selflink">NCDK.Smiles.SMARTS<span id="LSTD981E187_1"></span><script type="text/javascript">AddLanguageSpecificTextSet("LSTD981E187_1?cs=.|vb=.|cpp=::|nu=.|fs=.");</script>SMARTSQueryTool</span><br /></div><p> </p>
    <strong>Namespace:</strong> 
   <a href="N_NCDK_Smiles_SMARTS.htm">NCDK.Smiles.SMARTS</a><br />
    <strong>Assembly:</strong>
   NCDK (in NCDK.dll) Version: 1.0.0.0 (1.0.0.0)<div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID2RB')" onkeypress="SectionExpandCollapse_CheckKey('ID2RB', event)" tabindex="0"><img id="ID2RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Syntax</span></div><div id="ID2RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerTabs"><div id="ID1EACA_tab1" class="codeSnippetContainerTabSingle">C#</div></div><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EACA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EACA');return false;" title="Copy">Copy</a></div></div><div id="ID1EACA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve"><span class="keyword">public</span> <span class="keyword">class</span> <span class="identifier">SMARTSQueryTool</span></pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EACA");</script></div><p>The <span class="selflink">SMARTSQueryTool</span> type exposes the following members.</p><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID3RB')" onkeypress="SectionExpandCollapse_CheckKey('ID3RB', event)" tabindex="0"><img id="ID3RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Constructors</span></div><div id="ID3RBSection" class="collapsibleSection"><table class="members" id="constructorList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_NCDK_Smiles_SMARTS_SMARTSQueryTool__ctor.htm">SMARTSQueryTool</a></td><td><div class="summary">
            Create a new SMARTS query tool for the specified SMARTS string. Query
            objects will contain a reference to the specified <a href="T_NCDK_IChemObjectBuilder.htm">IChemObjectBuilder</a>.
            </div></td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID4RB')" onkeypress="SectionExpandCollapse_CheckKey('ID4RB', event)" tabindex="0"><img id="ID4RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Properties</span></div><div id="ID4RBSection" class="collapsibleSection"><table class="members" id="propertyList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /></td><td><a href="P_NCDK_Smiles_SMARTS_SMARTSQueryTool_MatchesCount.htm">MatchesCount</a></td><td><div class="summary">
            Returns the number of times the pattern was found in the target molecule. 
            <p>This function should be called
            after <a href="M_NCDK_Smiles_SMARTS_SMARTSQueryTool_Matches.htm">Matches(IAtomContainer)</a>. If not, the results may be undefined.</p></div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubproperty.gif" alt="Public property" title="Public property" /></td><td><a href="P_NCDK_Smiles_SMARTS_SMARTSQueryTool_Smarts.htm">Smarts</a></td><td><div class="summary">
            The current SMARTS pattern being used.
            </div></td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID5RB')" onkeypress="SectionExpandCollapse_CheckKey('ID5RB', event)" tabindex="0"><img id="ID5RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Methods</span></div><div id="ID5RBSection" class="collapsibleSection"><table class="members" id="methodList"><tr><th class="iconColumn">
								 
							</th><th>Name</th><th>Description</th></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/bsc2ak47" target="_blank">Equals</a></td><td> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="protected;inherited;notNetfw;"><td><img src="../icons/protmethod.gif" alt="Protected method" title="Protected method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/4k87zsw7" target="_blank">Finalize</a></td><td> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/zdee4b3y" target="_blank">GetHashCode</a></td><td> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_NCDK_Smiles_SMARTS_SMARTSQueryTool_GetMatchingAtoms.htm">GetMatchingAtoms</a></td><td><div class="summary">
            Get the atoms in the target molecule that match the query pattern. 
            <p>Since there may be multiple matches, the
            return value is a List of List objects. Each List object contains the indices of the atoms in the target
            molecule, that match the query pattern</p></div></td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/dfwy45w9" target="_blank">GetType</a></td><td> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_NCDK_Smiles_SMARTS_SMARTSQueryTool_GetUniqueMatchingAtoms.htm">GetUniqueMatchingAtoms</a></td><td><div class="summary">
            Get the atoms in the target molecule that match the query pattern. 
            <p>
            Since there may be multiple matches, the
            return value is a List of List objects. Each List object contains the unique set of indices of the atoms in the
            target molecule, that match the query pattern
            </p></div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_NCDK_Smiles_SMARTS_SMARTSQueryTool_Matches.htm">Matches(IAtomContainer)</a></td><td><div class="summary">
            Perform a SMARTS match and check whether the query is present in the target molecule. 
            <p>
            This function simply
            checks whether the query pattern matches the specified molecule. However the function will also, internally, save
            the mapping of query atoms to the target molecule</p></div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_NCDK_Smiles_SMARTS_SMARTSQueryTool_Matches_1.htm">Matches(IAtomContainer, Boolean)</a></td><td><div class="summary">
            Perform a SMARTS match and check whether the query is present in the target molecule. 
            <p>This function simply
            checks whether the query pattern matches the specified molecule. However the function will also, internally, save
            the mapping of query atoms to the target molecule</p></div></td></tr><tr data="protected;inherited;notNetfw;"><td><img src="../icons/protmethod.gif" alt="Protected method" title="Protected method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/57ctke0a" target="_blank">MemberwiseClone</a></td><td> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /><img src="../icons/CodeExample.png" alt="Code example" title="Code example" /></td><td><a href="M_NCDK_Smiles_SMARTS_SMARTSQueryTool_SetAromaticity.htm">SetAromaticity</a></td><td><div class="summary">
            Set the aromaticity perception to use. Different aromaticity models
            may required certain attributes to be set (e.g. atom typing). These
            will not be automatically configured and should be preset before matching.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_NCDK_Smiles_SMARTS_SMARTSQueryTool_SetQueryCacheSize.htm">SetQueryCacheSize</a></td><td><div class="summary">
            Set the maximum size of the query cache.
            </div></td></tr><tr data="public;inherited;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="http://msdn2.microsoft.com/en-us/library/7bxwbwt2" target="_blank">ToString</a></td><td> (Inherited from <a href="http://msdn2.microsoft.com/en-us/library/e5kfa45b" target="_blank">Object</a>.)</td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_NCDK_Smiles_SMARTS_SMARTSQueryTool_UseEssentialRings.htm">UseEssentialRings</a></td><td><div class="summary">
            Indicates that ring properties should use the Essential Rings (default).
            The set is unique but only includes a subset of the SSSR.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_NCDK_Smiles_SMARTS_SMARTSQueryTool_UseRelevantRings.htm">UseRelevantRings</a></td><td><div class="summary">
            Indicates that ring properties should use the Relevant Rings. The set is
            unique and includes all of the SSSR but may be exponential in size.
            </div></td></tr><tr data="public;declared;notNetfw;"><td><img src="../icons/pubmethod.gif" alt="Public method" title="Public method" /></td><td><a href="M_NCDK_Smiles_SMARTS_SMARTSQueryTool_UseSmallestSetOfSmallestRings.htm">UseSmallestSetOfSmallestRings</a></td><td><div class="summary">
            Indicates that ring properties should use the Smallest Set of Smallest
            Rings. The set is not unique and may lead to ambiguous matches.
            </div></td></tr></table><a href="#PageHeader">Top</a></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID6RB')" onkeypress="SectionExpandCollapse_CheckKey('ID6RB', event)" tabindex="0"><img id="ID6RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Remarks</span></div><div id="ID6RBSection" class="collapsibleSection"><p>
            User code that wants to do
            SMARTS matching should use this rather than using SMARTSParser (and <a href="T_NCDK_Isomorphisms_UniversalIsomorphismTester.htm">UniversalIsomorphismTester</a>) directly.
            </p><ul><li>Component level grouping</li><li>Stereochemistry</li><li>Reaction support</li></ul><h3>SMARTS Extensions</h3><p>
            Currently the CDK supports the following SMARTS symbols, that are not described in the Daylight specification.
            However they are supported by other packages and are noted as such.
            </p><div class="tableSection"><table><tr><th>Symbol</th><th>Meaning</th><th>Default</th><th>Notes</th></tr><tr><td>Gx</td><td>Periodic group number</td><td>None</td><td>x must be specified and must be a number between 1 and 18. This symbol is supported by the MOE SMARTS implementation</td></tr><tr><td>#X</td><td>Any non-carbon heavy element</td><td>None</td><td>This symbol is supported by the MOE SMARTS implementation</td></tr><tr><td>^x</td><td>Any atom with the a specified hybridization state</td><td>None</td><td>x must be specified and should be between 1 and 8 (inclusive), corresponding to SP1, SP2, SP3, SP3D1, SP3D2 SP3D3, SP3D4 and SP3D5. Supported by the OpenEye SMARTS implementation</td></tr></table></div><div class="alert"><table><tr><th><img src="../icons/AlertNote.png" alt="Note" /> Note</th></tr><tr><td><ul><li><strong>
            As <a href="http://sourceforge.net/mailarchive/message.php?msg_name=4964F605.1070502%40emolecules.com" target="_blank">described</a>
            by Craig James the "h&lt;n&gt;" SMARTS pattern should not be used. It was included in the Daylight spec
            for backwards compatibility. To match hydrogens, use the "H&lt;n&gt;" pattern.
            
            The wild card pattern ("*") will not match hydrogens (explicit or implicit) unless an isotope is specified. In other
            words, "*" gives two hits against "C[2H]" but 1 hit against "C[H]". This also means
            that it gives no hits against "[H][H]". This is contrary to what is shown by Daylights 
            <a href="http://www.daylight.com/daycgi_tutorials/depictmatch.cgi" target="_blank">depictmatch</a> service, but is based on this 
            <a href="https://sourceforge.net/mailarchive/message.php?msg_name=4964FF9D.3040004%40emolecules.com" target="_blank">discussion</a>. A
            work around to get "*" to match "[H][H]" is to write it in the form "[1H][1H]".
            <p>
            It's not entirely clear what the behavior of * should be with respect to hydrogens. it is possible that the code will
            be updated so that "*" will not match <i>any</i> hydrogen in the future.</p>
            The CDKHueckelAromaticityDetector only considers single rings and two fused non-spiro
            rings. As a result, it does not properly detect aromaticity in polycyclic systems such as
            "[O-]C(=O)c1ccccc1c2c3ccc([O-])cc3oc4cc(=O)ccc24". Thus SMARTS patterns that depend on proper aromaticity
            detection may not work correctly in such polycyclic systems
            </strong> - </li></ul></td></tr></table></div></div><div class="collapsibleAreaRegion"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID7RB')" onkeypress="SectionExpandCollapse_CheckKey('ID7RB', event)" tabindex="0"><img id="ID7RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />Examples</span></div><div id="ID7RBSection" class="collapsibleSection"><div class="codeSnippetContainer"><div class="codeSnippetContainerCodeContainer"><div class="codeSnippetToolBar"><div class="codeSnippetToolBarText"><a id="ID1EAAABA_copyCode" href="#" class="copyCodeSnippet" onclick="javascript:CopyToClipboard('ID1EAAABA');return false;" title="Copy">Copy</a></div></div><div id="ID1EAAABA_code_Div1" class="codeSnippetContainerCode" style="display: block"><pre xml:space="preserve">SmilesParser sp = <span class="highlight-keyword">new</span> SmilesParser(Default.ChemObjectBuilder.Instance);
IAtomContainer atomContainer = sp.ParseSmiles(<span class="highlight-literal">"CC(=O)OC(=O)C"</span>);
SMARTSQueryTool querytool = <span class="highlight-keyword">new</span> SMARTSQueryTool(<span class="highlight-literal">"O=CO"</span>, Silent.ChemObjectBuilder.Instance);
<span class="highlight-keyword">bool</span> status = querytool.Matches(atomContainer);
<span class="highlight-keyword">if</span> (status)
{
    <span class="highlight-keyword">int</span> nmatch = querytool.MatchesCount;
    IList&lt;IList&lt;<span class="highlight-keyword">int</span>&gt;&gt; mappings = querytool.GetMatchingAtoms();
    <span class="highlight-keyword">for</span> (<span class="highlight-keyword">int</span> i = <span class="highlight-number">0</span>; i &lt; nmatch; i++)
    {
        IList&lt;<span class="highlight-keyword">int</span>&gt; atomIndices = mappings[i];
    }
}</pre></div></div></div><script type="text/javascript">AddLanguageTabSet("ID1EAAABA");</script></div><div class="collapsibleAreaRegion" id="seeAlsoSection"><span class="collapsibleRegionTitle" onclick="SectionExpandCollapse('ID8RB')" onkeypress="SectionExpandCollapse_CheckKey('ID8RB', event)" tabindex="0"><img id="ID8RBToggle" class="collapseToggle" src="../icons/SectionExpanded.png" />See Also</span></div><div id="ID8RBSection" class="collapsibleSection"><h4 class="subHeading">Reference</h4><div class="seeAlsoStyle"><a href="N_NCDK_Smiles_SMARTS.htm">NCDK.Smiles.SMARTS Namespace</a></div></div></div></div><div id="pageFooter" class="pageFooter"><p>Copyright © 2016-2017 Kazuya Ujihara</p> </div></body></html>